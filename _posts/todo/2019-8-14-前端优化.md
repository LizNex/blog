---
layout: post
title: "前端性能优化"
subtitle: ""
date: 2018-08-14 12:00:00
author: "左手喝水"
header-img: "img/post-bg-2015.jpg"
tags:
  - 综合
---

## js

### script 位置

通常`script`标签放在 body 底部以避免浏览器解析 HTML 文档时被阻塞。  
`script`标签的`defer async` 这两个属性也可以帮助解析；  
`defer`属性的作用类似于把`script`标签放在 body 底部，会在`DOMContentLoad`事件之后加载，多个`script`按照顺序加载  
`async`属性为异步加载标签，异步任务完成以后马上执行，不等待；可能会阻塞渲染，返回的顺序也不定，所以适用脚本之间互相没有依赖的情况

### 递归

### 内存溢出

### 垃圾回收

将无用的变量赋值为`null`可以释放内存空间

### 节流防抖

节流采用在高频率输入的情况，如滚动、移动、输入等。控制一段时间的交互频次。  
防抖采用在某些连续交互中间间歇执行某些操作，如输入搜索输入后需要发起请求搜索内容

## css

### 嵌套层级

嵌套的选择器将会从右向左解析（从子级到父级）以保证正确性，所以嵌套到层级更深会需要更多到解析时间；但是这些解析时间一般并不是性能瓶颈

## 动画

### 什么时候采用 css 或 js 动画

> - 使用 CSS 动画来实现较简单的“一次性”转换，例如切换 UI 元素状态。
> - 当您需要高级效果（例如弹跳、停止、暂停、倒退或减速）时，请使用 JavaScript 动画。
> - 如果选择使用 JavaScript 来编写动画，可选用 Web Animations API 或用起来顺手的现代框架
> - 当您为 UI 元素采用较小的独立状态时，使用 CSS。 CSS 变换和动画非常适合于从侧面引入导航菜单，或显示工具提示。最后，可以使用 JavaScript 来控制状态，但动画本身是采用 CSS。
> - 在需要对动画进行大量控制时，使用 JavaScript。 Web Animations API 是一个基于标准的方法，现已在 Chrome 和 Opera 中提供。该方法可提供实际对象，非常适合复杂的对象导向型应用。在需要停止、暂停、减速或倒退时，JavaScript 也非常有用。
> - 如果您需要手动协调整个场景，可直接使用 requestAnimationFrame。这属于高级 JavaScript 方法，但如果您构建游戏或绘制到 HTML 画布，则该方法非常有用。

### will-change

在正常动画动作时，浏览器并不知道将要开始动画只有执行到了相关代码才开始执行动画，这样猝不及防执行动画都是 CPU 临场发挥，而在这方面专业的 GPU 却被晾在一边；这时候就是`will-change`登场了，这个属性提前告诉浏览器：“元素要开始变形了快准备一下”CPU 这时候就把 GPU 拉出来帮手准备处理动画，CPU 也可以处理自己的事情。

不过也不能乱用`will-change`属性，因为没有任务的时候也让 GPU 随时准备着是要消耗性能，手机端的话会消耗更多的电量；所以用完以后要去除。

## html

### 嵌套深度

## 交互

### 懒加载

图片懒加载：从后端获得图片的请求路径，在用户没有滑到图片区域前不请求图片，把图片地址存起来。等滑到了以后再请求图片（配置`img`标签`src`属性）

### 预加载

图片预加载：在用户还没有画到图片是通过`Image`对象加载同步到内存中，需要到时候直接拿出来使用；

### 首屏加载

## 构建

### 按需加载

### 代码压缩

### 图片质量

### 去除无用代码

## 网络

### HTTP2.0

### CDN

### HTTPS

## 浏览器

### 缓存

### 重绘重排

## 服务器

### 负载均衡

### 服务检测

参考：
谷歌开发者-动画：<https://developers.google.com/web/fundamentals/design-and-ux/animations/css-vs-javascript?hl=zh-cn>

张鑫旭-will-change：<https://www.zhangxinxu.com/wordpress/2015/11/css3-will-change-improve-paint/>

知乎-全新 Chrome Devtool Performance 使用指南
:<https://zhuanlan.zhihu.com/p/29879682>

segement-浅谈 script 标签的 defer 和 async:<https://segmentfault.com/a/1190000006778717>
